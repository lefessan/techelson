parameter int;
storage (set int);
code { DUP ;
       DIP { CDR @storage_slash_1 } ;
       CAR @parameter_slash_2 ;
       DUUP @storage ;
       DUUP @parameter ;
       PAIR ;
       PUSH bool True ;
       LOOP { RENAME @x_slash_3 ;
              DUP @x ;
              CAR @count ;
              DUUP @x ;
              CDR @storage ;
              PUSH int 0 ;
              DUUUP @count ;
              COMPARE ;
              GE ;
              IF { DUP @storage ;
                   DUUUP @count ;
                   DIP { PUSH bool True } ;
                   UPDATE @storage ;
                   PUSH int 1 ;
                   DUUUUP @count ;
                   SUB ;
                   PAIR ;
                   PUSH bool True ;
                   PAIR }
                 { DUP @storage ; DUUUP @count ; PAIR ; PUSH bool False ; PAIR } ;
              DIP { DROP ; DROP ; DROP } ;
              DUP ;
              CAR ;
              DIP { CDR } ;
              PRINT_STACK ;
              STEP "loop";
              } ;
       DIP { DROP ; DROP } ;
       RENAME @x ;
       CDR @storage ;
       NIL operation ;
       PAIR };
